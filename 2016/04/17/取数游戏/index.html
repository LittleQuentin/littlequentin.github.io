<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>取数游戏 | LittleRed</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="题意：有两个由自然数组成的数列A和B，长度为N和M(N,M&amp;lt;=5000)。现在每次都可以在两个数列的左侧取走任意个数（对于每个数列，每次至少取走一个数）这样做会产生Σa[i]Σb[i]（在A数列中取走数字和乘在B数列中取走数字的和）的费用。求把两个数列取完时的最少费用。由于每次至少在两个数列中都取一个，所以要同时取完两个序列。">
<meta property="og:type" content="article">
<meta property="og:title" content="取数游戏">
<meta property="og:url" content="http://yoursite.com/2016/04/17/取数游戏/index.html">
<meta property="og:site_name" content="LittleRed">
<meta property="og:description" content="题意：有两个由自然数组成的数列A和B，长度为N和M(N,M&amp;lt;=5000)。现在每次都可以在两个数列的左侧取走任意个数（对于每个数列，每次至少取走一个数）这样做会产生Σa[i]Σb[i]（在A数列中取走数字和乘在B数列中取走数字的和）的费用。求把两个数列取完时的最少费用。由于每次至少在两个数列中都取一个，所以要同时取完两个序列。">
<meta property="og:updated_time" content="2016-04-17T13:23:26.426Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="取数游戏">
<meta name="twitter:description" content="题意：有两个由自然数组成的数列A和B，长度为N和M(N,M&amp;lt;=5000)。现在每次都可以在两个数列的左侧取走任意个数（对于每个数列，每次至少取走一个数）这样做会产生Σa[i]Σb[i]（在A数列中取走数字和乘在B数列中取走数字的和）的费用。求把两个数列取完时的最少费用。由于每次至少在两个数列中都取一个，所以要同时取完两个序列。">
  
    <link rel="alternate" href="/atom.xml" title="LittleRed" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">LittleRed</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">...and they have escaped the weight of DARKNESS</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-取数游戏" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/17/取数游戏/" class="article-date">
  <time datetime="2016-04-17T03:57:21.000Z" itemprop="datePublished">2016-04-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      取数游戏
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>题意：有两个由自然数组成的数列A和B，长度为N和M(N,M&lt;=5000)。<br>现在每次都可以在两个数列的左侧取走任意个数（对于每个数列，每次至少取走一个数）<br>这样做会产生Σa[i]<em>Σb[i]（在A数列中取走数字和乘在B数列中取走数字的和）的费用。<br>求把两个数列取完时的最少费用。由于每次至少在两个数列中都取一个，所以要同时取完两个序列。<br><a id="more"></a><br>很容易看出来的最优子结构，那么就考虑动态规划了。<br>首先我们考虑（N</em>M)^2的做法，令f[i][j]表示已经取掉了A数列的前i个和B数列的前j个的最小费用。<br>按顺序枚举所有的状态，对于每个f[i][j]都找到f[x]<a href="x&lt;i,y&lt;j">y</a>,更新f[i][j]的解。<br>这样做可以保证正确性，但复杂度显然太劣了。</p>
<p>考虑问题的性质，我们要求的是最小费用的解。<br>现在假设把我们随机构造一个断点，把取走的A序列的和分成a1和a2，B序列的和分成b1和b2。<br>那么产生的费用就是(a1+a2)<em>(b1+b2)<br>因为问题对取的次数没有限制，而这个局部状态的解显然不如a1</em>b1+a2<em>b2（分开取这两段）<br>通过不停地把序列这样分开来，我们就发现其实每次我们取走的两个子序列中必定有一个序列的长度为1，否则的话这个序列肯定可以被继续分段来优化问题的解。<br>这样的话对于每个状态f[i][j],我们只要枚举所有的f[i-1]<a href="k&lt;j">k</a>,f[k]<a href="k&lt;i">j-1</a>来更新f[i][j]就行了。<br>时间复杂度就可以做到(N</em>M)*(N+M)，但对于这样的数据规模而言复杂度也不符合要求。</p>
<p>考虑上述DP算法的冗余之处：每次都要枚举一遍k来更新最优解，但是其实我们只要选出其中最优的那个就可以了。</p>
<p>接下来我们先考虑如何优化通过f[i-1][k]来更新f[i][j]的过程：<br>这样暴力枚举太低效了。假设我们现在要更新f[i][j],已近得到了一个k(k&lt;j)，要通过f[i-1][k]来更新f[i][j],那么这个时候如果f[i][j]被更新了，新的f[i][j]就等于f[i-1][k]+a[i]<em>Σb[k+1~j]。<br>我们发现暴力枚举k的过程，其实就是在寻找最小的那个f[i-1][k]+a[i]</em>Σb[k+1~j].<br>有趣的是，任何一个f[i-1][k]+a[i]<em>Σb[k+1~j]，其实都是通过某个f[x][y]得出来的，但实际上我们总共只有N</em>M个状态。只有当我们得到一个新的f[i][j]时，才会去产生新的可能更优的f[i-1][k]+a[i]*Σb[k+1~j]。</p>
<p>让我们尝试维护一个数组LA[i][j]，表示的意义是，对于所有的f[i-1]<a href="k&lt;j">k</a>,最小的那个f[i-1][k]+a[i]*Σb[k+1~j]。假设现在已近求出了LA[i][j],那么就可以O(1)更新f[i][j]了。但这种做法似乎不能成功，因为我们在维护一个LA[x][y]并准备用它去更新一个f[i][j]时，无法得知未来要选取的j是多少。————不过尽管这种做法不可行，但是这种维护一个数组来优化更新的思想很有启蒙意义。</p>
<p>重新考虑如何来维护LA数组。对于任意一个f[i-1][k]+a[i]<em>Σb[k+1~j]，其中的Σb[k+1~j]都可以表示为Σb[j]-Σb[k]，更新一个优于当前解的f[i][j]时，j是确定的;当我们维护LA时，k是确定的。<br>考虑这样构造LA数组：LA[i][j]表示对于所有的f[i-1]<a href="k&lt;j">k</a>，f[i-1][k]-a[i]</em>Σb[k]的最小值。<br>那么对于任何一个f[i][j]，在用LA[i][j]来更新它的时候加上a[i]<em>Σb[j]就是实际最小的f[i-1][k]+a[i]</em>Σb[k+1~j]，因为所有小于等于k的b[j]都已近在之前通过f[i-1][k]维护LA的时候被减掉了。<br>维护LA的方法按照定义即可，任何一个LA[i][j]都继承LA[i][j-1],并且考虑用f[i][j-1]-a[i]*Σb[1~j-1]更新LA[i][j]。</p>
<p>通过完全相同的方法我们也可以构造出一个LB数组来优化通过f[k][j-1]更新f[i][j]的过程。这样一来问题就迎刃而解了。因为我们只有N<em>M个f[i][j],所以LA、LB也只会被更新N</em>M次，每次更新也都是O(1)的。时空复杂度皆为N*M。<br>实际上，LA、LB就是在对f的状态进行动态规划，通过对状态的动态规划来优化对解的动态规划。</p>
<p>在我看来，这真的是一道非常好的题目，尤其是这种通过对状态进行DP来优化全局DP的思想，非常值得借鉴学习。<br>从早上开始想到晚上的题目。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/17/取数游戏/" data-id="cin41wliv0006k8a9ehhmviei" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/动态规划/">动态规划</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2016/04/16/2016-4-16/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">2016.4.16</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/MyLife/">MyLife</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/动态规划/">动态规划</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/哲学/">哲学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/差分约束/">差分约束</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/最短路/">最短路</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络流/">网络流</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/MyLife/" style="font-size: 10px;">MyLife</a> <a href="/tags/动态规划/" style="font-size: 10px;">动态规划</a> <a href="/tags/哲学/" style="font-size: 10px;">哲学</a> <a href="/tags/差分约束/" style="font-size: 10px;">差分约束</a> <a href="/tags/最短路/" style="font-size: 10px;">最短路</a> <a href="/tags/网络流/" style="font-size: 10px;">网络流</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/04/17/取数游戏/">取数游戏</a>
          </li>
        
          <li>
            <a href="/2016/04/16/2016-4-16/">2016.4.16</a>
          </li>
        
          <li>
            <a href="/2016/04/13/BZOJ2330-糖果-差分约束/">BZOJ2330 糖果 差分约束</a>
          </li>
        
          <li>
            <a href="/2016/04/12/BZOJ2668交换棋子-费用流/">BZOJ2668交换棋子  费用流</a>
          </li>
        
          <li>
            <a href="/2016/04/12/helloworld/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 LittleRed<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>